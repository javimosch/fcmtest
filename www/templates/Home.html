<ion-view id="home" title="Accueil">
  <ion-nav-buttons side="right">
    <button class="button button-clear button-icon" ng-click="openNotificationsModal()">
        <i class="icon-smc-notification" style="font-size:32px;"></i>
    </button>
  </ion-nav-buttons>
    <ion-content overflow-scroll="true" padding="true" class="has-header">
        <div class="logo-centered">
            <img src="img/logo.png"></i>
        </div>
        <!-- <div>
            <span class="baseline">Vos courses livrées, avec Shop My Courses</p>
        </div> -->
        <button class="button button-positive button-block icon-right ion-chevron-right" ui-sref="tabs.shopdelivery" ng-if="(currentAvailability.length <= 0)">Proposer une livraison</button>
        <span ng-if="(currentAvailability.length > 0)">
          <p>
            Vous avez <span ng-if='currentAvailability.length > 1'>des</span><span ng-if='currentAvailability.length <= 1'>une</span> disponibilité<span ng-if='currentAvailability.length > 1'>s</span> prévue<span ng-if='currentAvailability.length > 1'>s</span> {{date}} dans le
            <span class="shop">{{currentAvailability[0].shop.name}}</span>
          </p>
        </span>
        <button class="button button-positive button-block icon-right ion-chevron-right" ng-click="cancelAvailability()" ng-if="(currentAvailability.length > 0)">Annuler <span ng-if='currentAvailability.length <= 1'>cette</span><span ng-if='currentAvailability.length > 1'>ces</span> disponibilité<span ng-if='currentAvailability.length > 1'>s</soan></button>
        <button class="button button-positive button-block icon-right ion-chevron-right" ui-sref="tabs.scheduleorder">Demander une livraison</button>
    </ion-content>
</ion-view>

<script id="NotificationsModal.html" type="text/ng-template">
  <ion-modal-view id="notifications" ng-controller="NotificationsCtrl">
    <ion-header-bar class="bar-positive">
      <span class="title center">Notifications</span>
      <button class="button button-icon button-clear icon ion-close-round" ng-click="closeNotificationsModal()"></button>
    </ion-header-bar>
    <ion-content overflow-scroll="true" padding="false" class="has-header">
        <ion-list>
          <div ng-repeat="notification in notifications">
            <ion-item class="item-icon-left main">
                <div class="title">
                  <i class="icon ion-android-notifications-none"></i>
                  {{notification.content}}
                </div>
            </ion-item>

            <!-- delivery_request -->
            <ion-item class="secondary" ng-if="notification.mode === 'delivery_request'">
              <div class="shop">{{notification.meta.shop.name}}</div>
              <div class="schedule"><i class="ion-ios-calendar-outline"></i> {{notification.meta.schedule.schedule}}</div>
              <div class="address"><i class="ion-ios-location"></i> {{notification.meta.address.address}}, {{notification.meta.address.city}}</div>
              <div class="recipient"><i class="ion-ios-person"></i> {{notification.meta.buyer.firstname}} {{notification.meta.buyer.lastname}}</div>
              <div class="stars">
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 1, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 1}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 2, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 2}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 3, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 3}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 4, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 4}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 5, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 5}"></i>
              </div>
              <div class="response row">
                <div class="col">
                  <button class="button button-positive button-block accept" ng-click="acceptDelivery(notification)">Accepter</button>
                </div>
                <div class="col">
                  <button class="button button-stable bordered button-block decline" ng-click="declineDelivery(notification)">Décliner</button>
                </div>
              </div>
            </ion-item>

            <!-- accepted_delivery -->
            <ion-item class="secondary" ng-if="notification.mode === 'accepted_delivery'">
              <div class="shop">{{notification.meta.shop.name}}</div>
              <div class="schedule"><i class="ion-ios-calendar-outline"></i> {{notification.meta.schedule.schedule}}</div>
              <div class="address"><i class="ion-ios-location"></i> {{notification.meta.address.address}}, {{notification.meta.address.city}}</div>
              <div class="recipient"><i class="ion-ios-person"></i> {{notification.meta.deliveryman.firstname}} {{notification.meta.deliveryman.lastname}}</div>
              <div class="stars">
                <i ng-class="{'ion-ios-star': notification.meta.deliveryman.rating_average >= 1, 'ion-ios-star-outline': notification.meta.deliveryman.rating_average < 1}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.deliveryman.rating_average >= 2, 'ion-ios-star-outline': notification.meta.deliveryman.rating_average < 2}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.deliveryman.rating_average >= 3, 'ion-ios-star-outline': notification.meta.deliveryman.rating_average < 3}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.deliveryman.rating_average >= 4, 'ion-ios-star-outline': notification.meta.deliveryman.rating_average < 4}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.deliveryman.rating_average >= 5, 'ion-ios-star-outline': notification.meta.deliveryman.rating_average < 5}"></i>
              </div>
              <div class="response row">
                <div class="col">
                  <button class="button button-positive button-block accept" ng-click="editCart(notification)">Parfait, je créé ma liste</button>
                  <button class="button button-positive button-block decline" ng-click="declineDelivery(notification)">Annuler la demande</button>
                </div>
              </div>
            </ion-item>

            <!-- cart_filled -->
            <ion-item class="secondary" ng-if="notification.mode === 'cart_filled'">
              <div class="shop">{{notification.meta.shop.name}}</div>
              <div class="schedule"><i class="ion-ios-calendar-outline"></i> {{notification.meta.schedule.schedule}}</div>
              <div class="address"><i class="ion-ios-location"></i> {{notification.meta.address.address}}, {{notification.meta.address.city}}</div>
              <div class="recipient"><i class="ion-ios-person"></i> {{notification.meta.buyer.firstname}} {{notification.meta.buyer.lastname}}</div>
              <div class="stars">
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 1, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 1}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 2, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 2}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 3, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 3}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 4, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 4}"></i>
                <i ng-class="{'ion-ios-star': notification.meta.buyer.rating_average >= 5, 'ion-ios-star-outline': notification.meta.buyer.rating_average < 5}"></i>
              </div>
              <div class="response row">
                <div class="col">
                  <button class="button button-positive button-block accept" ng-click="goDelivery(notification)">Consulter la commande</button>
                </div>
              </div>
            </ion-item>

            <!-- outdated_delivery -->
            <ion-item class="secondary" ng-if="notification.mode === 'outdated_delivery'">
              <div class="shop">{{notification.meta.shop.name}}</div>
              <div class="schedule"><i class="ion-ios-calendar-outline"></i> {{notification.meta.schedule.schedule}}</div>
              <div class="address"><i class="ion-ios-location"></i> {{notification.meta.address.address}}, {{notification.meta.address.city}}</div>
              <div class="recipient"><i class="ion-ios-person"></i> {{notification.meta.buyer.firstname}} {{notification.meta.buyer.lastname}}</div>
              <div class="response row">
                <div class="col">
                  <div class="title">{{notification.content}}</div>
                  <button class="button button-positive button-block" ng-click="declineDelivery(notification)">D'accord</button>
                </div>
              </div>
            </ion-item>
          </div>
          <ion-item class="secondary" ng-if="notifications.length == 0">
            Vous n'avez aucune notification
          </ion-item>
        </ion-list>
    </ion-content>
  </ion-model-view>
</script>

<script id="default-modal.html" type="text/ng-template">
  <ion-modal-view class="default-modal">
      <ion-content scroll="false" padding="true">
          <span class="title">{{modalTitle}}</span>
          <p>{{modalMessage}}</p>
          <button class="button button-stable button-block" ng-click="modalClose()">Ok</button>
      </ion-content>
  </ion-modal-view>
</script>
