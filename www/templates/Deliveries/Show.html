<ion-view id="delivery" title="Détail">
    <ion-content overflow-scroll="true" padding="false" class="has-header">
      <div id="delivery-header">
        <div class="item item-avatar">
          <i class="profil-pic icon-smc-profile" style="font-size:300%;"></i>
          <div class="name">{{delivery.buyer.firstname}} {{delivery.buyer.lastname}}</div>
          <div class="stars">
            <i ng-class="{'ion-ios-star-outline': delivery.buyer.rating_average < 1, 'ion-ios-star': delivery.buyer.rating_average >= 1}"></i>
            <i ng-class="{'ion-ios-star-outline': delivery.buyer.rating_average < 2, 'ion-ios-star': delivery.buyer.rating_average >= 2}"></i>
            <i ng-class="{'ion-ios-star-outline': delivery.buyer.rating_average < 3, 'ion-ios-star': delivery.buyer.rating_average >= 3}"></i>
            <i ng-class="{'ion-ios-star-outline': delivery.buyer.rating_average < 4, 'ion-ios-star': delivery.buyer.rating_average >= 4}"></i>
            <i ng-class="{'ion-ios-star-outline': delivery.buyer.rating_average < 5, 'ion-ios-star': delivery.buyer.rating_average >= 5}"></i>
          </div>
        </div>
        <div class="address"><i class="ion-ios-location-outline"></i> {{delivery.address.address}}, {{delivery.address.zip}} {{delivery.address.city}}</div>
        <div class="actions">
          <button class="button button-positive" ng-click="openFinishDeliveryModal()" ng-if="delivery.status === 'completed'">Finaliser la commande</button>
          <button class="button button-stable bordered" ng-if="delivery.buyer.share_phone" ng-click="sendSMS()">Contacter par SMS</button>
          <div ng-if="!delivery.buyer.share_phone">
            L'acheteur ne souhaite pas être contacté.
          </div>
        </div>
      </div>
      <div id="delivery-prices" class="row">
        <div class="price-box total col">
          <span class="price">{{delivery.total || 0 | number: 2}}€</span>
          <span class="title">Prix total</span>
        </div>
        <div class="price-box commission col">
          <span class="price">{{delivery.shipping_total || 0 | number: 2}}€</span>
          <span class="title">Commission</span>
        </div>
      </div>
      <ion-list>
          <div class="item title">
            Liste des produits
          </div>
          <div ng-if="delivery.delivery_contents.length == 0 || delivery.status === 'accepted'" style="text-align: center;">L'acheteur n'a pas encore rempli son panier</div>
          <ion-item class="item product" ng-repeat="delivery_content in delivery.delivery_contents" ng-if="delivery.status != 'accepted'">
              <img ng-src="{{delivery_content.product.image_url}}" alt="{{delivery_content.product.name}}">
              <div class="name">{{delivery_content.product.name}}</div>
              <div class="detail">{{delivery_content.product.detail}}</div>
              <div class="price">{{delivery_content.unit_price*delivery_content.quantity | number: 2 || 0}}€ ({{delivery_content.quantity}})</div>
          </ion-item>
      </ion-list>
    </ion-content>
</ion-view>
